"omniglot_maml_omniglot_20_way_1_shot_maml_0_few_shot.sh" running bash file 
------------------\n
"omniglot_maml_omniglot_20_way_1_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_20_way_1_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_20_way_1_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 7 3 2]
[0.88040541 0.87440878 0.86748311 0.86385135 0.84467905]
{'test_accuracy_mean': 0.917820945945946, 'test_accuracy_std': 0.2746373192572978}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_20_way_1_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_20_way_1_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_20_way_1_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_20_way_1_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
0 50000
------------------\n
"omniglot_maml_omniglot_20_way_1_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_20_way_1_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_20_way_1_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[8 6 7 5 4]
[0.86731419 0.86410473 0.85734797 0.85219595 0.81824324]
{'test_accuracy_mean': 0.9150337837837837, 'test_accuracy_std': 0.2788314155867581}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_20_way_1_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_20_way_1_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_20_way_1_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_20_way_1_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
0 50000
------------------\n
"omniglot_maml_omniglot_20_way_1_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_20_way_1_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_20_way_1_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
5000 50000
[8 6 7 5 3]
[0.85405405 0.83834459 0.83226351 0.82837838 0.81663851]
{'test_accuracy_mean': 0.9173141891891892, 'test_accuracy_std': 0.27540673103860336}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_20_way_1_shot_maml_2/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_20_way_1_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_20_way_1_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_20_way_1_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
0 50000
------------------\n
"omniglot_maml_omniglot_20_way_3_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_20_way_3_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_20_way_3_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[7 4 8 6 3]
[0.95084459 0.94434122 0.94214527 0.94138514 0.94096284]
{'test_accuracy_mean': 0.9717905405405406, 'test_accuracy_std': 0.16557078805291883}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_20_way_3_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_20_way_3_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_20_way_3_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 20 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_20_way_3_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 20])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([20, 64])
layer_dict.linear.bias torch.Size([20])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([20, 64])
classifier.layer_dict.linear.bias torch.Size([20])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
3500 50000
[5 3 4 2 1]
[0.93555743 0.93023649 0.92331081 0.91967905 0.90658784]
{'test_accuracy_mean': 0.9684121621621622, 'test_accuracy_std': 0.17490010388381216}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_20_way_3_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_1_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_1_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_1_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.96959459 0.96858108 0.96418919 0.95608108 0.95236486]
{'test_accuracy_mean': 0.981418918918919, 'test_accuracy_std': 0.1350400848153591}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_1_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 5 7 4]
[0.98277027 0.98141892 0.98141892 0.98074324 0.97702703]
{'test_accuracy_mean': 0.9881756756756757, 'test_accuracy_std': 0.10809491051200104}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.97398649 0.97027027 0.96587838 0.96182432 0.96148649]
{'test_accuracy_mean': 0.9847972972972973, 'test_accuracy_std': 0.12235841014509766}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN_MSL.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 7 5 4]
[0.97736486 0.9722973  0.96216216 0.96013514 0.95033784]
{'test_accuracy_mean': 0.9837837837837838, 'test_accuracy_std': 0.12630617778970726}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_BN_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 7 5 4]
[0.98445946 0.98310811 0.98141892 0.98006757 0.97432432]
{'test_accuracy_mean': 0.9871621621621621, 'test_accuracy_std': 0.11257454311471674}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_BN_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_BN <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_BN.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[7 6 8 5 4]
[0.98141892 0.97939189 0.9777027  0.97567568 0.9722973 ]
{'test_accuracy_mean': 0.9847972972972973, 'test_accuracy_std': 0.12235841014509766}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_BN/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_MSL.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.98513514 0.98141892 0.98074324 0.98074324 0.97837838]
{'test_accuracy_mean': 0.9847972972972973, 'test_accuracy_std': 0.12235841014509766}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_LSLR_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml0005_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml0005 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.0005 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml0005.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[7 8 6 5 4]
[0.98209459 0.98141892 0.97804054 0.97702703 0.97668919]
{'test_accuracy_mean': 0.9837837837837838, 'test_accuracy_std': 0.12630617778970726}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml0005/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml005_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml005 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.005 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml005.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 7 4 3]
[0.98817568 0.98614865 0.98513514 0.98412162 0.98277027]
{'test_accuracy_mean': 0.9885135135135135, 'test_accuracy_std': 0.10655771729294058}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ml005/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_MSL.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.97635135 0.96993243 0.96452703 0.95641892 0.95202703]
{'test_accuracy_mean': 0.9861486486486486, 'test_accuracy_std': 0.11687382691215673}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns2.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 2 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 3136])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 6])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 3136])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 6])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 3136])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.79831081 0.76689189 0.71216216 0.66351351 0.63682432]
{'test_accuracy_mean': 0.7726351351351352, 'test_accuracy_std': 0.4191301505378092}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns2/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns6_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns6 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns6.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 6 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
torch.Size([2, 64, 1, 1])
torch.Size([2, 64, 1, 1])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv4.conv.bias torch.Size([64])
layer_dict.conv4.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv4.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv4.norm_layer.bias torch.Size([5, 64])
layer_dict.conv4.norm_layer.weight torch.Size([5, 64])
layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv5.conv.bias torch.Size([64])
layer_dict.conv5.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv5.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv5.norm_layer.bias torch.Size([5, 64])
layer_dict.conv5.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 14])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv4.conv.bias torch.Size([64])
classifier.layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv5.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 14])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv4.conv.bias torch.Size([64])
classifier.layer_dict.conv4.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv4.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv5.conv.bias torch.Size([64])
classifier.layer_dict.conv5.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv5.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 6 7 5 4]
[0.94324324 0.92635135 0.92364865 0.90743243 0.88682432]
{'test_accuracy_mean': 0.9587837837837838, 'test_accuracy_std': 0.1987899387218436}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_0_ns6/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_1_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_1_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_1_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
10000 50000
[13 16 15 12 14]
[0.98918919 0.98885135 0.9875     0.98716216 0.98716216]
{'test_accuracy_mean': 0.9875, 'test_accuracy_std': 0.11110243021644485}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_1_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 8 4 6 5]
[0.98783784 0.98581081 0.98547297 0.98378378 0.98277027]
{'test_accuracy_mean': 0.9905405405405405, 'test_accuracy_std': 0.09679864712997957}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[8 7 6 4 5]
[0.98344595 0.98310811 0.98006757 0.97331081 0.97128378]
{'test_accuracy_mean': 0.9851351351351352, 'test_accuracy_std': 0.12101198559404837}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN_MSL.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 5 8 6 4]
[0.97297297 0.96486486 0.96385135 0.96385135 0.96351351]
{'test_accuracy_mean': 0.9851351351351352, 'test_accuracy_std': 0.12101198559404835}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_BN_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[5 8 4 7 6]
[0.98716216 0.98209459 0.98040541 0.98040541 0.97635135]
{'test_accuracy_mean': 0.9841216216216216, 'test_accuracy_std': 0.12500502181293127}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_BN_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_BN <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_BN.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 8 6 5 4]
[0.98851351 0.98817568 0.9847973  0.98445946 0.97804054]
{'test_accuracy_mean': 0.989527027027027, 'test_accuracy_std': 0.1018002446464661}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_BN/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_MSL.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 8 6 5 4]
[0.98986486 0.98682432 0.98648649 0.9847973  0.98277027]
{'test_accuracy_mean': 0.9905405405405405, 'test_accuracy_std': 0.09679864712997957}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_LSLR_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml0005_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml0005 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.0005 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml0005.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 8 5 6 4]
[0.9875     0.98513514 0.98412162 0.98209459 0.97668919]
{'test_accuracy_mean': 0.9871621621621621, 'test_accuracy_std': 0.11257454311471674}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml0005/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml005_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml005 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.005 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml005.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[5 8 6 3 4]
[0.9902027  0.98885135 0.98783784 0.98547297 0.98445946]
{'test_accuracy_mean': 0.9932432432432432, 'test_accuracy_std': 0.08192132197960905}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ml005/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_MSL_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_MSL <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_MSL.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[8 7 5 6 3]
[0.98040541 0.98006757 0.97736486 0.97567568 0.96385135]
{'test_accuracy_mean': 0.9834459459459459, 'test_accuracy_std': 0.1275931712452885}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_MSL/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns2.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 2 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 3136])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 6])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 3136])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 6])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 3136])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[8 7 6 5 4]
[0.78952703 0.76554054 0.73952703 0.70135135 0.67094595]
{'test_accuracy_mean': 0.7486486486486487, 'test_accuracy_std': 0.4337900984637626}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns2/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns6_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns6 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns6.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 6 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
torch.Size([2, 64, 1, 1])
torch.Size([2, 64, 1, 1])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv4.conv.bias torch.Size([64])
layer_dict.conv4.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv4.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv4.norm_layer.bias torch.Size([5, 64])
layer_dict.conv4.norm_layer.weight torch.Size([5, 64])
layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv5.conv.bias torch.Size([64])
layer_dict.conv5.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv5.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv5.norm_layer.bias torch.Size([5, 64])
layer_dict.conv5.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 14])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv4.conv.bias torch.Size([64])
classifier.layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv5.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 14])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv4.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv4.conv.bias torch.Size([64])
classifier.layer_dict.conv4.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv4.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv5.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv5.conv.bias torch.Size([64])
classifier.layer_dict.conv5.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv5.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 6 5 4 8]
[0.95       0.94054054 0.91689189 0.9152027  0.88581081]
{'test_accuracy_mean': 0.9445945945945946, 'test_accuracy_std': 0.2287698547826354}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_1_ns6/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_1_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_1_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_1_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
10000 50000
[17 15 12 13 16]
[0.98175676 0.98108108 0.98108108 0.98040541 0.98006757]
{'test_accuracy_mean': 0.9908783783783783, 'test_accuracy_std': 0.09507059293290217}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_1_shot_maml_2/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_1_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_1_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 1 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_1_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
5000 50000
[6 7 8 5 4]
[0.98412162 0.98141892 0.98006757 0.97804054 0.9777027 ]
{'test_accuracy_mean': 0.9905405405405405, 'test_accuracy_std': 0.09679864712997957}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_1_shot_maml_2/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_3_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_3_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_3_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 3 5]
[0.9777027  0.97702703 0.97601351 0.97195946 0.96452703]
{'test_accuracy_mean': 0.9939189189189189, 'test_accuracy_std': 0.07774381990850718}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_3_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_3_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_3_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_3_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 5 3 7 4]
[0.99459459 0.99222973 0.99155405 0.99087838 0.9902027 ]
{'test_accuracy_mean': 0.9972972972972973, 'test_accuracy_std': 0.051917223546752836}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_3_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_3_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_3_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_3_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 8 6 3 5]
[0.98547297 0.98513514 0.98277027 0.9777027  0.9777027 ]
{'test_accuracy_mean': 0.9908783783783783, 'test_accuracy_std': 0.09507059293290217}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_3_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_3_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_3_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_3_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[7 6 5 3 8]
[0.99391892 0.99324324 0.99290541 0.99155405 0.99054054]
{'test_accuracy_mean': 0.9962837837837838, 'test_accuracy_std': 0.06084739890291571}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_3_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_3_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_3_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_3_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
5000 50000
[7 8 6 5 4]
[0.98378378 0.98074324 0.98006757 0.97837838 0.97331081]
{'test_accuracy_mean': 0.9912162162162163, 'test_accuracy_std': 0.09330931853905866}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_3_shot_maml_2/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_3_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_3_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 3 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_3_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
5000 50000
[7 8 5 6 3]
[0.99493243 0.99256757 0.99155405 0.98986486 0.98918919]
{'test_accuracy_mean': 0.9962837837837838, 'test_accuracy_std': 0.06084739890291571}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_3_shot_maml_2/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_5_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_5_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 5 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_5_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[8 7 6 5 4]
[0.98378378 0.98141892 0.97635135 0.97567568 0.9722973 ]
{'test_accuracy_mean': 0.9861486486486486, 'test_accuracy_std': 0.11687382691215673}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_5_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_5_shot_maml_0_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_5_shot_maml_0 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 5 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_5_shot_maml_0.json <class 'str'>
train_seed 0 <class 'int'>
val_seed 0 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 985773, val_seed: 985773, at start time
5000 50000
[7 4 8 6 3]
[0.9972973  0.99594595 0.99527027 0.99493243 0.99493243]
{'test_accuracy_mean': 0.9962837837837838, 'test_accuracy_std': 0.060847398902915704}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_5_shot_maml_0/logs/test_summary.csv
------------------\n
"omniglot_maml_omniglot_5_way_5_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml_omniglot_5_way_5_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics False <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 5 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml_omniglot_5_way_5_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate False <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization False <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([64])
layer_dict.conv0.norm_layer.running_var torch.Size([64])
layer_dict.conv0.norm_layer.bias torch.Size([64])
layer_dict.conv0.norm_layer.weight torch.Size([64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([64])
layer_dict.conv1.norm_layer.running_var torch.Size([64])
layer_dict.conv1.norm_layer.bias torch.Size([64])
layer_dict.conv1.norm_layer.weight torch.Size([64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([64])
layer_dict.conv2.norm_layer.running_var torch.Size([64])
layer_dict.conv2.norm_layer.bias torch.Size([64])
layer_dict.conv2.norm_layer.weight torch.Size([64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([64])
layer_dict.conv3.norm_layer.running_var torch.Size([64])
layer_dict.conv3.norm_layer.bias torch.Size([64])
layer_dict.conv3.norm_layer.weight torch.Size([64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
15000 50000
[22 21 25 23 20]
[0.99527027 0.99425676 0.99425676 0.99391892 0.99358108]
{'test_accuracy_mean': 0.9972972972972973, 'test_accuracy_std': 0.051917223546752836}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml_omniglot_5_way_5_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_5_shot_maml_1_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_5_shot_maml_1 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 5 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_5_shot_maml_1.json <class 'str'>
train_seed 1 <class 'int'>
val_seed 1 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 128038, val_seed: 128038, at start time
5000 50000
[6 7 4 8 3]
[0.99594595 0.99527027 0.99358108 0.99290541 0.99222973]
{'test_accuracy_mean': 0.9969594594594594, 'test_accuracy_std': 0.05505720346840975}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_5_shot_maml_1/logs/test_summary.csv
------------------\n
"omniglot_maml++_omniglot_5_way_5_shot_maml_2_few_shot.sh" running bash file 
batch_size 16 <class 'int'>
image_height 28 <class 'int'>
image_width 28 <class 'int'>
image_channels 1 <class 'int'>
reset_stored_filepaths False <class 'bool'>
reverse_channels False <class 'bool'>
num_of_gpus 1 <class 'int'>
indexes_of_folders_indicating_class [-3, -2] <class 'list'>
train_val_test_split [0.70918052988, 0.03080714725, 0.2606284658] <class 'list'>
samples_per_iter 1 <class 'int'>
labels_as_int False <class 'bool'>
seed 104 <class 'int'>
env_only False <class 'bool'>
gpu_to_use 0 <class 'int'>
num_dataprovider_workers 4 <class 'int'>
max_models_to_save 5 <class 'int'>
dataset_name omniglot_dataset <class 'str'>
dataset_path datasets/datasets/omniglot_dataset
dataset_path datasets/omniglot_dataset <class 'str'>
reset_stored_paths False <class 'bool'>
experiment_name omniglot_maml++_omniglot_5_way_5_shot_maml_2 <class 'str'>
architecture_name None <class 'NoneType'>
continue_from_epoch latest <class 'str'>
dropout_rate_value 0.0 <class 'float'>
num_target_samples 1 <class 'int'>
second_order True <class 'bool'>
total_epochs 100 <class 'int'>
total_iter_per_epoch 500 <class 'int'>
min_learning_rate 1e-05 <class 'float'>
meta_learning_rate 0.001 <class 'float'>
meta_opt_bn False <class 'bool'>
task_learning_rate -1 <class 'int'>
norm_layer batch_norm <class 'str'>
max_pooling True <class 'bool'>
per_step_bn_statistics True <class 'bool'>
num_classes_per_set 5 <class 'int'>
cnn_num_blocks 4 <class 'int'>
number_of_training_steps_per_iter 5 <class 'int'>
number_of_evaluation_steps_per_iter 5 <class 'int'>
cnn_num_filters 64 <class 'int'>
cnn_blocks_per_stage 1 <class 'int'>
num_samples_per_class 5 <class 'int'>
name_of_args_json_file experiment_config/omniglot_maml++_omniglot_5_way_5_shot_maml_2.json <class 'str'>
train_seed 2 <class 'int'>
val_seed 2 <class 'int'>
load_from_npz_files False <class 'bool'>
sets_are_pre_split False <class 'bool'>
load_into_memory True <class 'bool'>
init_inner_loop_learning_rate 0.1 <class 'float'>
train_in_stages False <class 'bool'>
multi_step_loss_num_epochs 10 <class 'int'>
minimum_per_task_contribution 0.01 <class 'float'>
num_evaluation_tasks 600 <class 'int'>
learnable_per_layer_per_step_inner_loop_learning_rate True <class 'bool'>
enable_inner_loop_optimizable_bn_params False <class 'bool'>
evaluate_on_test_set_only False <class 'bool'>
learnable_batch_norm_momentum False <class 'bool'>
evalute_on_test_set_only False <class 'bool'>
learnable_bn_gamma True <class 'bool'>
learnable_bn_beta True <class 'bool'>
weight_decay 0.0 <class 'float'>
total_epochs_before_pause 10 <class 'int'>
first_order_to_second_order_epoch -1 <class 'int'>
num_stages 4 <class 'int'>
conv_padding 1 <class 'int'>
use_multi_step_loss_optimization True <class 'bool'>
eval_only True <class 'bool'>
Using max pooling
torch.Size([2, 64, 28, 28])
torch.Size([2, 64, 14, 14])
torch.Size([2, 64, 7, 7])
torch.Size([2, 64, 3, 3])
VGGNetwork build torch.Size([2, 5])
meta network params
layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
layer_dict.conv0.conv.bias torch.Size([64])
layer_dict.conv0.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv0.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv1.conv.bias torch.Size([64])
layer_dict.conv1.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv1.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv2.conv.bias torch.Size([64])
layer_dict.conv2.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv2.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
layer_dict.conv3.conv.bias torch.Size([64])
layer_dict.conv3.norm_layer.running_mean torch.Size([5, 64])
layer_dict.conv3.norm_layer.running_var torch.Size([5, 64])
layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
layer_dict.linear.weights torch.Size([5, 64])
layer_dict.linear.bias torch.Size([5])
Inner Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
Outer Loop parameters
task_learning_rate torch.Size([5, 10])
classifier.layer_dict.conv0.conv.weight torch.Size([64, 1, 3, 3])
classifier.layer_dict.conv0.conv.bias torch.Size([64])
classifier.layer_dict.conv0.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv0.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv1.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv1.conv.bias torch.Size([64])
classifier.layer_dict.conv1.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv1.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv2.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv2.conv.bias torch.Size([64])
classifier.layer_dict.conv2.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv2.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.conv3.conv.weight torch.Size([64, 64, 3, 3])
classifier.layer_dict.conv3.conv.bias torch.Size([64])
classifier.layer_dict.conv3.norm_layer.bias torch.Size([5, 64])
classifier.layer_dict.conv3.norm_layer.weight torch.Size([5, 64])
classifier.layer_dict.linear.weights torch.Size([5, 64])
classifier.layer_dict.linear.bias torch.Size([5])
datasets/omniglot_dataset
count stuff________________________________________ 32460
file count is correct
attempting to find existing checkpoint
1150 1200 1623
Loading data into RAM
Currently loading into memory the train set
Currently loading into memory the val set
Currently loading into memory the test set
data {'train': 23000, 'val': 1000, 'test': 8460}
train_seed 875689, val_seed: 875689, at start time
5000 50000
[4 6 5 8 7]
[0.99628378 0.99594595 0.99459459 0.99391892 0.99358108]
{'test_accuracy_mean': 0.9969594594594594, 'test_accuracy_std': 0.05505720346840975}
saved test performance at /home/akvasov/repos/HowToTrainYourMAMLPytorch/omniglot_maml++_omniglot_5_way_5_shot_maml_2/logs/test_summary.csv
